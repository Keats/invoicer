var chalk, errSign, happySign, isWin, table, warnSign;

chalk = require('chalk');

table = require('text-table');

isWin = process.platform === 'win32';

warnSign = "" + (isWin ? '' : '⚠');

errSign = "" + (isWin ? '' : '✖');

happySign = "" + (isWin ? '' : '✔');

exports.reporter = function(filename, results) {
  var errs, ret, warns;
  if (filename == null) {
    filename = '';
  }
  if (results == null) {
    results = [];
  }
  errs = 0;
  warns = 0;
  ret = '';
  if (filename) {
    ret = '\n' + chalk.underline(filename) + '\n';
  }
  ret += table(results.map(function(result) {
    var context, level, lineNumber, message;
    level = result.level, lineNumber = result.lineNumber, message = result.message, context = result.context;
    if (level === 'error') {
      errs++;
    }
    if (level === 'warn') {
      warns++;
    }
    return ['', chalk.gray(level === 'error' ? errSign : warnSign), chalk.gray('line ' + lineNumber), chalk.blue(message), chalk.gray(context || '')];
  }));
  ret += '\n\n';
  if (warns > 0) {
    ret += chalk.yellow.bold("" + warnSign + " " + warns + " warning" + (warns === 1 ? '' : 's'));
    if (errs > 0) {
      ret += '\n';
    }
  }
  if (errs > 0) {
    ret += chalk.red.bold("" + errSign + " " + errs + " error" + (errs === 1 ? '' : 's'));
  }
  if (errs === 0 && warns === 0) {
    ret += chalk.green.bold("" + happySign + " No problems");
    ret = '\n' + ret.trim();
  }
  return console.log(ret + '\n');
};

module.exports = exports;
